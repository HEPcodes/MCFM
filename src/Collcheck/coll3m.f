      subroutine coll3m(p,i,jpt)
      implicit none
      include 'constants.f'
      integer i,jpt,ii1(2),ii2(2),ii3(2),ii4(2),ii5(2),
     .              if1(2),if2(2),if3(2),if4(2),if5(2),
     .        iorf(5),pntr(5),ip
      double precision p(mxpart,4),dot,
     . pi1(4),pi2(4),pi3(4),pi4(4),pi5(4),pi6(4),
     . qi1(4),qi2(4),qi3(4),qi4(4),qi5(4),qi6(4),
     . ri1(4),ri2(4),ri3(4),ri4(4),ri5(4),ri6(4),
     . si1(4),si2(4),si3(4),si4(4),si5(4),si6(4),
     . ti1(4),ti2(4),ti3(4),ti4(4),ti5(4),ti6(4),
     . pf1(4),pf2(4),pf3(4),pf4(4),pf5(4),pf6(4),
     . qf1(4),qf2(4),qf3(4),qf4(4),qf5(4),qf6(4),
     . rf1(4),rf2(4),rf3(4),rf4(4),rf5(4),rf6(4),
     . sf1(4),sf2(4),sf3(4),sf4(4),sf5(4),sf6(4),
     . tf1(4),tf2(4),tf3(4),tf4(4),tf5(4),tf6(4)
      integer n2,n3
      
c--- momenta for (1,6) collinear
      data pi1/     0.00000000000000d0,    0.00000000000000d0,
     .     -2.11204130824879d0,   -2.11204130824879d0/
      data pi2/     0.00000000000000d0,    0.00000000000000d0,
     .     65.51450578791896d0,  -65.51450578791896d0/
      data pi3/     4.44250439736196d0,    0.30720010751842d0,
     .    -62.67609863495250d0,   62.85199724213173d0/
      data pi4/    -4.44253274872112d0,   -0.30720368164464d0,
     .     -0.74347639740520d0,    4.75743927748681d0/
      data pi5/     0.00002835135916d0,    0.00000357412622d0,
     .      0.01711055268752d0,    0.01711057654921d0/

      data qi1/     0.00000000000000d0,    0.00000000000000d0,
     .     -2.60664476264073d0,   -2.60664476264073d0/
      data qi2/     0.00000000000000d0,    0.00000000000000d0,
     .    101.28637626267533d0, -101.28637626267533d0/
      data qi3/    -3.05067071940559d0,    5.29526882917391d0,
     .    -97.21485647069072d0,   97.41829798568878d0/
      data qi4/     3.05064896294252d0,   -5.29527310632860d0,
     .     -1.47619820593177d0,    6.46339984133006d0/
      data qi5/     0.00002175646307d0,    0.00000427715469d0,
     .      0.01132317658789d0,    0.01132319829722d0/

      data ri1/     0.00000000000000d0,    0.00000000000000d0,
     .     -2.10689238132304d0,   -2.10689238132304d0/
      data ri2/     0.00000000000000d0,    0.00000000000000d0,
     .    112.79044557989710d0, -112.79044557989710d0/
      data ri3/    -4.98461910432973d0,  -10.65841919431899d0,
     .    -91.90752691624192d0,   92.66979999545057d0/
      data ri4/     4.98458803414338d0,   10.65841644776123d0,
     .    -18.78610247803407d0,   22.21746172179058d0/
      data ri5/     0.00003107018634d0,    0.00000274655776d0,
     .      0.01007619570193d0,    0.01007624397897d0/

      data si1/     0.00000000000000d0,    0.00000000000000d0,
     .     -2.03666193881603d0,   -2.03666193881603d0/
      data si2/     0.00000000000000d0,    0.00000000000000d0,
     .     69.95403800295983d0,  -69.95403800295983d0/
      data si3/    -9.32188383539038d0,    2.36508848910354d0,
     .    -54.68554989524842d0,   55.54503154331184d0/
      data si4/     9.32185548334923d0,   -2.36509202415881d0,
     .    -13.24257731441133d0,   16.43491721498314d0/
      data si5/     0.00002835204115d0,    0.00000353505527d0,
     .      0.01075114551594d0,    0.01075118348089d0/

      data ti1/     0.00000000000000d0,    0.00000000000000d0,
     .     -1.30032677677463d0,   -1.30032677677463d0/
      data ti2/     0.00000000000000d0,    0.00000000000000d0,
     .    108.89704500169280d0, -108.89704500169280d0/
      data ti3/     9.09021177898086d0,    7.44637027321579d0,
     .    -52.18637567860550d0,   53.51399991498582d0/
      data ti4/    -9.09024293806778d0,   -7.44637966293525d0,
     .    -55.42090287204253d0,   56.67281148760875d0/
      data ti5/     0.00003115908691d0,    0.00000938971946d0,
     .      0.01056032572985d0,    0.01056037587286d0/

c--- momenta for (5,6) collinear
c--- mass=1
      data pf1/     0.00000000000000d0,    0.00000000000000d0,
     .     -0.05450725577543d0,   -0.05450725577543d0/
      data pf2/     0.00000000000000d0,    0.00000000000000d0,
     .    628.73910096372322d0, -628.73910096372322d0/
      data pf3/    -5.53313816185190d0,    1.25771279315837d0,
     .   -258.71166385876086d0,  258.77581509089424d0/
      data pf4/     5.53309643304340d0,   -1.25772868377446d0,
     .   -369.95818551505113d0,  370.00304872685621d0/
      data pf5/     0.00004172880851d0,    0.00001589061609d0,
     .     -0.01474433413577d0,    0.01474440174820d0/

c--- mass=0.1
      data qf1/     0.00000000000000d0,    0.00000000000000d0,
     .     -0.04897049879173d0,   -0.04897049879173d0/
      data qf2/     0.00000000000000d0,    0.00000000000000d0,
     .    734.31517495800210d0, -734.31517495800210d0/
      data qf3/     2.18305325969524d0,   -3.40911421792814d0,
     .    -96.31452788941678d0,   96.39961651296539d0/
      data qf4/    -2.18303569054078d0,    3.40913713261779d0,
     .   -637.92556763925268d0,  637.93841999732069d0/
      data qf5/    -0.00001756915447d0,   -0.00002291468965d0,
     .     -0.02610893054087d0,    0.02610894650778d0/

c--- mass=1.5 from here on
      data rf1/     0.00000000000000d0,    0.00000000000000d0,
     .     -0.01545123914462d0,   -0.01545123914462d0/
      data rf2/     0.00000000000000d0,    0.00000000000000d0,
     .    667.55949265807726d0, -667.55949265807726d0/
      data rf3/    -1.26212533474584d0,   -1.19119665663035d0,
     .   -100.15461162138854d0,  100.18087711168509d0/
      data rf4/     1.26209707390438d0,    1.19119028084918d0,
     .   -567.37691106090801d0,  567.38154801537803d0/
      data rf5/     0.00002826084146d0,    0.00000637578116d0,
     .     -0.01251873663609d0,    0.01251877015883d0/

      data sf1/     0.00000000000000d0,    0.00000000000000d0,
     .     -0.01387429563647d0,   -0.01387429563647d0/
      data sf2/     0.00000000000000d0,    0.00000000000000d0,
     .    594.20466603198872d0, -594.20466603198872d0/
      data sf3/    -1.27444778944831d0,   -0.06490221545802d0,
     .    -80.88764346599400d0,   80.91161409184323d0/
      data sf4/     1.27441719830253d0,    0.06489782057240d0,
     .   -513.28807039034461d0,  513.29184832409499d0/
      data sf5/     0.00003059114578d0,    0.00000439488562d0,
     .     -0.01507788001362d0,    0.01507791168691d0/
    
      data tf1/     0.00000000000000d0,    0.00000000000000d0,
     .     -0.00757178181510d0,   -0.00757178181510d0/
      data tf2/     0.00000000000000d0,    0.00000000000000d0,
     .    777.06945428449808d0, -777.06945428449808d0/
      data tf3/    -0.20175628443137d0,   -0.21833687663339d0,
     .    -86.92586998729344d0,   86.93931935343092d0/
      data tf4/     0.20172611652811d0,    0.21833368123676d0,
     .   -690.12087027251221d0,  690.12256443961610d0/
      data tf5/     0.00003016790326d0,    0.00000319539663d0,
     .     -0.01514224287721d0,    0.01514227326611d0/

c--- jpt picks the momentum configuration (1..5)
c--- k picks the collinear pair:
c---  1   2   3   4   5 
c---  15  25  35  45  34

c--- handle permutations (initial,final)
      data ii1/1,2/
      data ii2/2,1/
      data ii3/3,3/
      data ii4/4,4/
      data ii5/5,5/
c--- handle permutations (final,final)
      data if1/1,1/
      data if2/2,2/
      data if3/3,4/
      data if4/4,3/
      data if5/5,5/

c-- translate i to (i,f)/(f,f) and perm
      data iorf/1,1,2,2,1/
      data pntr/1,2,1,2,1/

      ip=pntr(i)

      if (iorf(i) .eq. 1) then
      
c--- initial-final case
      if (jpt. eq. 1) then
      p(ii1(ip),1)=pi1(1)
      p(ii1(ip),2)=pi1(2)
      p(ii1(ip),3)=pi1(3)
      p(ii1(ip),4)=pi1(4)

      p(ii2(ip),1)=pi2(1)
      p(ii2(ip),2)=pi2(2)
      p(ii2(ip),3)=pi2(3)
      p(ii2(ip),4)=pi2(4)

      p(ii3(ip),1)=pi3(1)
      p(ii3(ip),2)=pi3(2)
      p(ii3(ip),3)=pi3(3)
      p(ii3(ip),4)=pi3(4)

      p(ii4(ip),1)=pi4(1)
      p(ii4(ip),2)=pi4(2)
      p(ii4(ip),3)=pi4(3)
      p(ii4(ip),4)=pi4(4)

      p(ii5(ip),1)=pi5(1)
      p(ii5(ip),2)=pi5(2)
      p(ii5(ip),3)=pi5(3)
      p(ii5(ip),4)=pi5(4)

      elseif (jpt .eq. 2) then
      p(ii1(ip),1)=qi1(1)
      p(ii1(ip),2)=qi1(2)
      p(ii1(ip),3)=qi1(3)
      p(ii1(ip),4)=qi1(4)

      p(ii2(ip),1)=qi2(1)
      p(ii2(ip),2)=qi2(2)
      p(ii2(ip),3)=qi2(3)
      p(ii2(ip),4)=qi2(4)

      p(ii3(ip),1)=qi3(1)
      p(ii3(ip),2)=qi3(2)
      p(ii3(ip),3)=qi3(3)
      p(ii3(ip),4)=qi3(4)

      p(ii4(ip),1)=qi4(1)
      p(ii4(ip),2)=qi4(2)
      p(ii4(ip),3)=qi4(3)
      p(ii4(ip),4)=qi4(4)

      p(ii5(ip),1)=qi5(1)
      p(ii5(ip),2)=qi5(2)
      p(ii5(ip),3)=qi5(3)
      p(ii5(ip),4)=qi5(4)

      elseif (jpt .eq. 3) then
      p(ii1(ip),1)=ri1(1)
      p(ii1(ip),2)=ri1(2)
      p(ii1(ip),3)=ri1(3)
      p(ii1(ip),4)=ri1(4)

      p(ii2(ip),1)=ri2(1)
      p(ii2(ip),2)=ri2(2)
      p(ii2(ip),3)=ri2(3)
      p(ii2(ip),4)=ri2(4)

      p(ii3(ip),1)=ri3(1)
      p(ii3(ip),2)=ri3(2)
      p(ii3(ip),3)=ri3(3)
      p(ii3(ip),4)=ri3(4)

      p(ii4(ip),1)=ri4(1)
      p(ii4(ip),2)=ri4(2)
      p(ii4(ip),3)=ri4(3)
      p(ii4(ip),4)=ri4(4)

      p(ii5(ip),1)=ri5(1)
      p(ii5(ip),2)=ri5(2)
      p(ii5(ip),3)=ri5(3)
      p(ii5(ip),4)=ri5(4)

      elseif (jpt .eq. 4) then
      p(ii1(ip),1)=si1(1)
      p(ii1(ip),2)=si1(2)
      p(ii1(ip),3)=si1(3)
      p(ii1(ip),4)=si1(4)

      p(ii2(ip),1)=si2(1)
      p(ii2(ip),2)=si2(2)
      p(ii2(ip),3)=si2(3)
      p(ii2(ip),4)=si2(4)

      p(ii3(ip),1)=si3(1)
      p(ii3(ip),2)=si3(2)
      p(ii3(ip),3)=si3(3)
      p(ii3(ip),4)=si3(4)

      p(ii4(ip),1)=si4(1)
      p(ii4(ip),2)=si4(2)
      p(ii4(ip),3)=si4(3)
      p(ii4(ip),4)=si4(4)

      p(ii5(ip),1)=si5(1)
      p(ii5(ip),2)=si5(2)
      p(ii5(ip),3)=si5(3)
      p(ii5(ip),4)=si5(4)

      elseif (jpt .eq. 5) then
      p(ii1(ip),1)=ti1(1)
      p(ii1(ip),2)=ti1(2)
      p(ii1(ip),3)=ti1(3)
      p(ii1(ip),4)=ti1(4)

      p(ii2(ip),1)=ti2(1)
      p(ii2(ip),2)=ti2(2)
      p(ii2(ip),3)=ti2(3)
      p(ii2(ip),4)=ti2(4)

      p(ii3(ip),1)=ti3(1)
      p(ii3(ip),2)=ti3(2)
      p(ii3(ip),3)=ti3(3)
      p(ii3(ip),4)=ti3(4)

      p(ii4(ip),1)=ti4(1)
      p(ii4(ip),2)=ti4(2)
      p(ii4(ip),3)=ti4(3)
      p(ii4(ip),4)=ti4(4)

      p(ii5(ip),1)=ti5(1)
      p(ii5(ip),2)=ti5(2)
      p(ii5(ip),3)=ti5(3)
      p(ii5(ip),4)=ti5(4)
      endif
      write(*,*) 'Small: s(',ii1(ip),',',ii5(ip),') =',
     . 2d0*dot(p,ii1(ip),ii5(ip))
      else
c--- final-final case
      if (jpt. eq. 1) then
c      mass2=1d0
      
      p(if1(ip),1)=pf1(1)
      p(if1(ip),2)=pf1(2)
      p(if1(ip),3)=pf1(3)
      p(if1(ip),4)=pf1(4)

      p(if2(ip),1)=pf2(1)
      p(if2(ip),2)=pf2(2)
      p(if2(ip),3)=pf2(3)
      p(if2(ip),4)=pf2(4)

      p(if3(ip),1)=pf3(1)
      p(if3(ip),2)=pf3(2)
      p(if3(ip),3)=pf3(3)
      p(if3(ip),4)=pf3(4)

      p(if4(ip),1)=pf4(1)
      p(if4(ip),2)=pf4(2)
      p(if4(ip),3)=pf4(3)
      p(if4(ip),4)=pf4(4)

      p(if5(ip),1)=pf5(1)
      p(if5(ip),2)=pf5(2)
      p(if5(ip),3)=pf5(3)
      p(if5(ip),4)=pf5(4)

      elseif (jpt .eq. 2) then
c      mass2=0.1d0
      
      p(if1(ip),1)=qf1(1)
      p(if1(ip),2)=qf1(2)
      p(if1(ip),3)=qf1(3)
      p(if1(ip),4)=qf1(4)

      p(if2(ip),1)=qf2(1)
      p(if2(ip),2)=qf2(2)
      p(if2(ip),3)=qf2(3)
      p(if2(ip),4)=qf2(4)

      p(if3(ip),1)=qf3(1)
      p(if3(ip),2)=qf3(2)
      p(if3(ip),3)=qf3(3)
      p(if3(ip),4)=qf3(4)

      p(if4(ip),1)=qf4(1)
      p(if4(ip),2)=qf4(2)
      p(if4(ip),3)=qf4(3)
      p(if4(ip),4)=qf4(4)

      p(if5(ip),1)=qf5(1)
      p(if5(ip),2)=qf5(2)
      p(if5(ip),3)=qf5(3)
      p(if5(ip),4)=qf5(4)

      elseif (jpt .eq. 3) then
c      mass2=1.5d0
      
      p(if1(ip),1)=rf1(1)
      p(if1(ip),2)=rf1(2)
      p(if1(ip),3)=rf1(3)
      p(if1(ip),4)=rf1(4)

      p(if2(ip),1)=rf2(1)
      p(if2(ip),2)=rf2(2)
      p(if2(ip),3)=rf2(3)
      p(if2(ip),4)=rf2(4)

      p(if3(ip),1)=rf3(1)
      p(if3(ip),2)=rf3(2)
      p(if3(ip),3)=rf3(3)
      p(if3(ip),4)=rf3(4)

      p(if4(ip),1)=rf4(1)
      p(if4(ip),2)=rf4(2)
      p(if4(ip),3)=rf4(3)
      p(if4(ip),4)=rf4(4)

      p(if5(ip),1)=rf5(1)
      p(if5(ip),2)=rf5(2)
      p(if5(ip),3)=rf5(3)
      p(if5(ip),4)=rf5(4)

      elseif (jpt .eq. 4) then
      p(if1(ip),1)=sf1(1)
      p(if1(ip),2)=sf1(2)
      p(if1(ip),3)=sf1(3)
      p(if1(ip),4)=sf1(4)

      p(if2(ip),1)=sf2(1)
      p(if2(ip),2)=sf2(2)
      p(if2(ip),3)=sf2(3)
      p(if2(ip),4)=sf2(4)

      p(if3(ip),1)=sf3(1)
      p(if3(ip),2)=sf3(2)
      p(if3(ip),3)=sf3(3)
      p(if3(ip),4)=sf3(4)

      p(if4(ip),1)=sf4(1)
      p(if4(ip),2)=sf4(2)
      p(if4(ip),3)=sf4(3)
      p(if4(ip),4)=sf4(4)

      p(if5(ip),1)=sf5(1)
      p(if5(ip),2)=sf5(2)
      p(if5(ip),3)=sf5(3)
      p(if5(ip),4)=sf5(4)

      elseif (jpt .eq. 5) then
      p(if1(ip),1)=tf1(1)
      p(if1(ip),2)=tf1(2)
      p(if1(ip),3)=tf1(3)
      p(if1(ip),4)=tf1(4)

      p(if2(ip),1)=tf2(1)
      p(if2(ip),2)=tf2(2)
      p(if2(ip),3)=tf2(3)
      p(if2(ip),4)=tf2(4)

      p(if3(ip),1)=tf3(1)
      p(if3(ip),2)=tf3(2)
      p(if3(ip),3)=tf3(3)
      p(if3(ip),4)=tf3(4)

      p(if4(ip),1)=tf4(1)
      p(if4(ip),2)=tf4(2)
      p(if4(ip),3)=tf4(3)
      p(if4(ip),4)=tf4(4)

      p(if5(ip),1)=tf5(1)
      p(if5(ip),2)=tf5(2)
      p(if5(ip),3)=tf5(3)
      p(if5(ip),4)=tf5(4)

      endif

      write(*,*) 'Small: s(',if4(ip),',',if5(ip),') =',
     . 2d0*dot(p,if4(ip),if5(ip))
      endif      

      return
      end
















