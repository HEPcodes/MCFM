      subroutine coll4a(p,i,jpt)
      implicit none
      include 'constants.f'
      integer i,jpt,ii1(4),ii2(4),ii3(4),ii4(4),ii5(4),ii6(4),
     .              if1(1),if2(1),if3(1),if4(1),if5(1),if6(1),
     .        iorf(5),pntr(5),ip
      double precision p(mxpart,4),dot,
     . pi1(4),pi2(4),pi3(4),pi4(4),pi5(4),pi6(4),
     . qi1(4),qi2(4),qi3(4),qi4(4),qi5(4),qi6(4),
     . ri1(4),ri2(4),ri3(4),ri4(4),ri5(4),ri6(4),
     . si1(4),si2(4),si3(4),si4(4),si5(4),si6(4),
     . ti1(4),ti2(4),ti3(4),ti4(4),ti5(4),ti6(4),
     . pf1(4),pf2(4),pf3(4),pf4(4),pf5(4),pf6(4),
     . qf1(4),qf2(4),qf3(4),qf4(4),qf5(4),qf6(4),
     . rf1(4),rf2(4),rf3(4),rf4(4),rf5(4),rf6(4),
     . sf1(4),sf2(4),sf3(4),sf4(4),sf5(4),sf6(4),
     . tf1(4),tf2(4),tf3(4),tf4(4),tf5(4),tf6(4)

c--- momenta for (1,6) collinear
      data pi1/     0.00000000000000d0,    0.00000000000000d0,
     .    -19.75334706123716d0,  -19.75334706123716d0/
      data pi2/     0.00000000000000d0,    0.00000000000000d0,
     .   3789.27040220088929d0,-3789.27040220088929d0/
      data pi3/   -50.94061328621405d0,  -38.68863000552967d0,
     .   -681.92664593135032d0,  684.92021915319572d0/
      data pi4/    -3.62590049984830d0,  -35.16986958956869d0,
     .  -2871.58656643735549d0, 2871.80421954994381d0/
      data pi5/    54.78100354966883d0,   73.86928452992275d0,
     .   -225.12018360065025d0,  243.18044043726459d0/
      data pi6/    -0.21448976360648d0,   -0.01078493482439d0,
     .      9.11634082970380d0,    9.11887012172210d0/
     
      data qi1/     0.00000000000000d0,    0.00000000000000d0,
     .   -791.63806657353211d0, -791.63806657353211d0/
      data qi2/     0.00000000000000d0,    0.00000000000000d0,
     .     13.48718783019319d0,  -13.48718783019319d0/
      data qi3/    65.66775892339213d0,   26.30690988435715d0,
     .    311.67742662012387d0,  319.60464066441079d0/
      data qi4/   -30.64390554784509d0,  -24.83353643116288d0,
     .     54.13774035441526d0,   66.98244851888609d0/
      data qi5/   -34.85555281123986d0,   -1.49180733193237d0,
     .     95.01673610767359d0,  101.21914439199742d0/
      data qi6/    -0.16830056430717d0,    0.01843387873810d0,
     .    317.31897566112622d0,  317.31902082843101d0/
     
      data ri1/     0.00000000000000d0,    0.00000000000000d0,
     .  -2360.13228067515865d0,-2360.13228067515865d0/
      data ri2/     0.00000000000000d0,    0.00000000000000d0,
     .     41.73538766263720d0,  -41.73538766263720d0/
      data ri3/    58.45368283889709d0,   -3.71773874352222d0,
     .     25.33157837451908d0,   63.81491582490617d0/
      data ri4/   124.34235764325004d0,  -24.14006182966872d0,
     .    340.49162521272427d0,  363.28819321500725d0/
      data ri5/  -182.78632919628109d0,   27.93470214935122d0,
     .    759.29332981880430d0,  781.48419717391062d0/
      data ri6/    -0.00971128586605d0,   -0.07690157616029d0,
     .   1193.28035960647389d0, 1193.28036212397183d0/     

      data si1/     0.00000000000000d0,    0.00000000000000d0,
     .  -1063.02026215073602d0,-1063.02026215073602d0/
      data si2/     0.00000000000000d0,    0.00000000000000d0,
     .      9.86190997447071d0,   -9.86190997447071d0/
      data si3/    71.04454796980278d0,   27.16828013123709d0,
     .    560.80202864883267d0,  565.93670898623384d0/
      data si4/   -25.97323293584750d0,  -10.30458157887841d0,
     .     41.13031754018778d0,   49.72420187003740d0/
      data si5/   -45.04939396909860d0,  -16.93849894954720d0,
     .    190.18557314517210d0,  196.18081678952322d0/
      data si6/    -0.02192106485668d0,    0.07480039718852d0,
     .    261.04043284207268d0,  261.04044447941237d0/

      data ti1/     0.00000000000000d0,    0.00000000000000d0,
     .   -440.26048651330643d0, -440.26048651330643d0/
      data ti2/     0.00000000000000d0,    0.00000000000000d0,
     .    553.02914919360558d0, -553.02914919360558d0/
      data ti3/  -231.28222240578248d0,  175.32283480866508d0,
     .   -209.77135675589955d0,  358.09717245674415d0/
      data ti4/  -107.79418545542734d0,   78.61667024088476d0,
     .     -9.44743278435035d0,  133.75134109225934d0/
      data ti5/   339.18421823516724d0, -253.87440634710748d0,
     .     29.72263900523045d0,  424.71353094448619d0/
      data ti6/    -0.10781037395742d0,   -0.06509870244236d0,
     .     76.72748785472031d0,   76.72759121342233d0/

c--- momenta for (5,6) collinear
      data pf1/     0.00000000000000d0,    0.00000000000000d0,
     .    -14.03716399468374d0,  -14.03716399468374d0/
      data pf2/     0.00000000000000d0,    0.00000000000000d0,
     .   1013.32351882422040d0,-1013.32351882422040d0/
      data pf3/    35.82726114043231d0,   19.28041021126898d0,
     .   -596.72227217322734d0,  598.10768007635454d0/
      data pf4/   -10.30375548274925d0,  -72.48565807049449d0,
     .   -316.78969303342228d0,  325.14004308170161d0/
      data pf5/    -8.39301167514725d0,   17.50534798945404d0,
     .    -28.31854030599011d0,   34.33394207301322d0/
      data pf6/   -17.13049398253581d0,   35.69989986977147d0,
     .    -57.45584931689693d0,   69.77901758783489d0/  
     
      data qf1/     0.00000000000000d0,    0.00000000000000d0,
     .    -16.15476097778899d0,  -16.15476097778899d0/
      data qf2/     0.00000000000000d0,    0.00000000000000d0,
     .   5481.75893142016321d0,-5481.75893142016321d0/
      data qf3/    26.90984906183112d0,   13.35749698061743d0,
     .  -1960.17426220998050d0, 1960.40447380956562d0/
      data qf4/   -25.49608948589124d0,  153.73618453029962d0,
     .  -3021.98483030701709d0, 3026.00019491386320d0/
      data qf5/    -1.06637025360795d0, -121.95767960998612d0,
     .   -352.60220737414886d0,  373.09935594489048d0/
      data qf6/    -0.34738932233193d0,  -45.13600190093095d0,
     .   -130.84287055122775d0,  138.40966772963316d0/
            
      data rf1/     0.00000000000000d0,    0.00000000000000d0,
     .    -24.33091456550539d0,  -24.33091456550539d0/
      data rf2/     0.00000000000000d0,    0.00000000000000d0,
     .   4366.16860447085764d0,-4366.16860447085764d0/
      data rf3/    29.13858155750635d0,  -24.74017329162921d0,
     .   -513.61236330500367d0,  515.03280754669822d0/
      data rf4/  -116.35245204765809d0, -157.93083732525835d0,
     .  -3355.45349773245152d0, 3361.18256242065854d0/
      data rf5/    58.74093330870011d0,  122.85725328889379d0,
     .   -318.03697582546533d0,  345.96520045212088d0/
      data rf6/    28.47293718145164d0,   59.81375732799378d0,
     .   -154.73485304243127d0,  168.31894861688573d0/
     
      data sf1/     0.00000000000000d0,    0.00000000000000d0,
     .     -4.35858833342086d0,   -4.35858833342086d0/
      data sf2/     0.00000000000000d0,    0.00000000000000d0,
     .   6869.96120076625994d0,-6869.96120076625994d0/
      data sf3/    36.40557313527754d0,   59.44587674940307d0,
     .  -2355.43100205611881d0, 2356.46226014016747d0/
      data sf4/   -66.92266132730626d0,   13.21657871494223d0,
     .  -4077.26156222089048d0, 4077.83216517256778d0/
      data sf5/     6.71789769004118d0,  -16.20659774719979d0,
     .    -95.86407409252584d0,   97.45616789885946d0/
      data sf6/    23.79919050198755d0,  -56.45585771714551d0,
     .   -337.04597406330402d0,  342.56919588808603d0/

      data tf1/     0.00000000000000d0,    0.00000000000000d0,
     .    -47.73167971552382d0,  -47.73167971552382d0/
      data tf2/     0.00000000000000d0,    0.00000000000000d0,
     .    377.72289803747668d0, -377.72289803747668d0/
      data tf3/    65.58838304671461d0,  -31.14732686437400d0,
     .   -166.83379406123288d0,  181.94918741875321d0/
      data tf4/    18.17886298109048d0,   74.96459168249349d0,
     .   -112.06474317846238d0,  136.04656456178142d0/
      data tf5/   -38.00813451580366d0,  -19.98286356320487d0,
     .    -23.19684861992762d0,   48.80601306655691d0/
      data tf6/   -45.75911151200143d0,  -23.83440125491462d0,
     .    -27.89583246232995d0,   58.65281270590899d0/
     
c--- jpt picks the momentum configuration (1..5)
c--- k picks the collinear pair:
c---  1   2   3   4   5 
c---  16  26  56  15  25

c--- handle permutations (initial,final)
      data ii1/1,2,1,2/
      data ii2/2,1,2,1/
      data ii3/3,3,3,3/
      data ii4/4,4,4,4/
      data ii5/5,5,6,6/
      data ii6/6,6,5,5/
c--- handle permutations (final,final)
      data if1/1/
      data if2/2/
      data if3/3/
      data if4/4/
      data if5/5/
      data if6/6/

c-- translate i to (i,f)/(f,f) and perm
      data iorf/1,1,2,1,1/
      data pntr/1,2,1,3,4/

      ip=pntr(i)

      if (iorf(i) .eq. 1) then
c--- initial-final case
      if (jpt .eq. 1) then
      p(ii1(ip),1)=pi1(1)
      p(ii1(ip),2)=pi1(2)
      p(ii1(ip),3)=pi1(3)
      p(ii1(ip),4)=pi1(4)

      p(ii2(ip),1)=pi2(1)
      p(ii2(ip),2)=pi2(2)
      p(ii2(ip),3)=pi2(3)
      p(ii2(ip),4)=pi2(4)

      p(ii3(ip),1)=pi3(1)
      p(ii3(ip),2)=pi3(2)
      p(ii3(ip),3)=pi3(3)
      p(ii3(ip),4)=pi3(4)

      p(ii4(ip),1)=pi4(1)
      p(ii4(ip),2)=pi4(2)
      p(ii4(ip),3)=pi4(3)
      p(ii4(ip),4)=pi4(4)

      p(ii5(ip),1)=pi5(1)
      p(ii5(ip),2)=pi5(2)
      p(ii5(ip),3)=pi5(3)
      p(ii5(ip),4)=pi5(4)

      p(ii6(ip),1)=pi6(1)
      p(ii6(ip),2)=pi6(2)
      p(ii6(ip),3)=pi6(3)
      p(ii6(ip),4)=pi6(4)

      elseif (jpt .eq. 2) then
      p(ii1(ip),1)=qi1(1)
      p(ii1(ip),2)=qi1(2)
      p(ii1(ip),3)=qi1(3)
      p(ii1(ip),4)=qi1(4)

      p(ii2(ip),1)=qi2(1)
      p(ii2(ip),2)=qi2(2)
      p(ii2(ip),3)=qi2(3)
      p(ii2(ip),4)=qi2(4)

      p(ii3(ip),1)=qi3(1)
      p(ii3(ip),2)=qi3(2)
      p(ii3(ip),3)=qi3(3)
      p(ii3(ip),4)=qi3(4)

      p(ii4(ip),1)=qi4(1)
      p(ii4(ip),2)=qi4(2)
      p(ii4(ip),3)=qi4(3)
      p(ii4(ip),4)=qi4(4)

      p(ii5(ip),1)=qi5(1)
      p(ii5(ip),2)=qi5(2)
      p(ii5(ip),3)=qi5(3)
      p(ii5(ip),4)=qi5(4)

      p(ii6(ip),1)=qi6(1)
      p(ii6(ip),2)=qi6(2)
      p(ii6(ip),3)=qi6(3)
      p(ii6(ip),4)=qi6(4)

      elseif (jpt .eq. 3) then
      p(ii1(ip),1)=ri1(1)
      p(ii1(ip),2)=ri1(2)
      p(ii1(ip),3)=ri1(3)
      p(ii1(ip),4)=ri1(4)

      p(ii2(ip),1)=ri2(1)
      p(ii2(ip),2)=ri2(2)
      p(ii2(ip),3)=ri2(3)
      p(ii2(ip),4)=ri2(4)

      p(ii3(ip),1)=ri3(1)
      p(ii3(ip),2)=ri3(2)
      p(ii3(ip),3)=ri3(3)
      p(ii3(ip),4)=ri3(4)

      p(ii4(ip),1)=ri4(1)
      p(ii4(ip),2)=ri4(2)
      p(ii4(ip),3)=ri4(3)
      p(ii4(ip),4)=ri4(4)

      p(ii5(ip),1)=ri5(1)
      p(ii5(ip),2)=ri5(2)
      p(ii5(ip),3)=ri5(3)
      p(ii5(ip),4)=ri5(4)

      p(ii6(ip),1)=ri6(1)
      p(ii6(ip),2)=ri6(2)
      p(ii6(ip),3)=ri6(3)
      p(ii6(ip),4)=ri6(4)

      elseif (jpt .eq. 4) then
      p(ii1(ip),1)=si1(1)
      p(ii1(ip),2)=si1(2)
      p(ii1(ip),3)=si1(3)
      p(ii1(ip),4)=si1(4)

      p(ii2(ip),1)=si2(1)
      p(ii2(ip),2)=si2(2)
      p(ii2(ip),3)=si2(3)
      p(ii2(ip),4)=si2(4)

      p(ii3(ip),1)=si3(1)
      p(ii3(ip),2)=si3(2)
      p(ii3(ip),3)=si3(3)
      p(ii3(ip),4)=si3(4)

      p(ii4(ip),1)=si4(1)
      p(ii4(ip),2)=si4(2)
      p(ii4(ip),3)=si4(3)
      p(ii4(ip),4)=si4(4)

      p(ii5(ip),1)=si5(1)
      p(ii5(ip),2)=si5(2)
      p(ii5(ip),3)=si5(3)
      p(ii5(ip),4)=si5(4)

      p(ii6(ip),1)=si6(1)
      p(ii6(ip),2)=si6(2)
      p(ii6(ip),3)=si6(3)
      p(ii6(ip),4)=si6(4)

      elseif (jpt .eq. 5) then
      p(ii1(ip),1)=ti1(1)
      p(ii1(ip),2)=ti1(2)
      p(ii1(ip),3)=ti1(3)
      p(ii1(ip),4)=ti1(4)

      p(ii2(ip),1)=ti2(1)
      p(ii2(ip),2)=ti2(2)
      p(ii2(ip),3)=ti2(3)
      p(ii2(ip),4)=ti2(4)

      p(ii3(ip),1)=ti3(1)
      p(ii3(ip),2)=ti3(2)
      p(ii3(ip),3)=ti3(3)
      p(ii3(ip),4)=ti3(4)

      p(ii4(ip),1)=ti4(1)
      p(ii4(ip),2)=ti4(2)
      p(ii4(ip),3)=ti4(3)
      p(ii4(ip),4)=ti4(4)

      p(ii5(ip),1)=ti5(1)
      p(ii5(ip),2)=ti5(2)
      p(ii5(ip),3)=ti5(3)
      p(ii5(ip),4)=ti5(4)

      p(ii6(ip),1)=ti6(1)
      p(ii6(ip),2)=ti6(2)
      p(ii6(ip),3)=ti6(3)
      p(ii6(ip),4)=ti6(4)

      endif
      write(*,*) 'Small: s(',ii1(ip),',',ii6(ip),') =',
     . 2d0*dot(p,ii1(ip),ii6(ip))
      else
c--- final-final case
      if (jpt .eq. 1) then
      p(if1(ip),1)=pf1(1)
      p(if1(ip),2)=pf1(2)
      p(if1(ip),3)=pf1(3)
      p(if1(ip),4)=pf1(4)

      p(if2(ip),1)=pf2(1)
      p(if2(ip),2)=pf2(2)
      p(if2(ip),3)=pf2(3)
      p(if2(ip),4)=pf2(4)

      p(if3(ip),1)=pf3(1)
      p(if3(ip),2)=pf3(2)
      p(if3(ip),3)=pf3(3)
      p(if3(ip),4)=pf3(4)

      p(if4(ip),1)=pf4(1)
      p(if4(ip),2)=pf4(2)
      p(if4(ip),3)=pf4(3)
      p(if4(ip),4)=pf4(4)

      p(if5(ip),1)=pf5(1)
      p(if5(ip),2)=pf5(2)
      p(if5(ip),3)=pf5(3)
      p(if5(ip),4)=pf5(4)

      p(if6(ip),1)=pf6(1)
      p(if6(ip),2)=pf6(2)
      p(if6(ip),3)=pf6(3)
      p(if6(ip),4)=pf6(4)

      elseif (jpt .eq. 2) then
      p(if1(ip),1)=qf1(1)
      p(if1(ip),2)=qf1(2)
      p(if1(ip),3)=qf1(3)
      p(if1(ip),4)=qf1(4)

      p(if2(ip),1)=qf2(1)
      p(if2(ip),2)=qf2(2)
      p(if2(ip),3)=qf2(3)
      p(if2(ip),4)=qf2(4)

      p(if3(ip),1)=qf3(1)
      p(if3(ip),2)=qf3(2)
      p(if3(ip),3)=qf3(3)
      p(if3(ip),4)=qf3(4)

      p(if4(ip),1)=qf4(1)
      p(if4(ip),2)=qf4(2)
      p(if4(ip),3)=qf4(3)
      p(if4(ip),4)=qf4(4)

      p(if5(ip),1)=qf5(1)
      p(if5(ip),2)=qf5(2)
      p(if5(ip),3)=qf5(3)
      p(if5(ip),4)=qf5(4)

      p(if6(ip),1)=qf6(1)
      p(if6(ip),2)=qf6(2)
      p(if6(ip),3)=qf6(3)
      p(if6(ip),4)=qf6(4)

      elseif (jpt .eq. 3) then
      p(if1(ip),1)=rf1(1)
      p(if1(ip),2)=rf1(2)
      p(if1(ip),3)=rf1(3)
      p(if1(ip),4)=rf1(4)

      p(if2(ip),1)=rf2(1)
      p(if2(ip),2)=rf2(2)
      p(if2(ip),3)=rf2(3)
      p(if2(ip),4)=rf2(4)

      p(if3(ip),1)=rf3(1)
      p(if3(ip),2)=rf3(2)
      p(if3(ip),3)=rf3(3)
      p(if3(ip),4)=rf3(4)

      p(if4(ip),1)=rf4(1)
      p(if4(ip),2)=rf4(2)
      p(if4(ip),3)=rf4(3)
      p(if4(ip),4)=rf4(4)

      p(if5(ip),1)=rf5(1)
      p(if5(ip),2)=rf5(2)
      p(if5(ip),3)=rf5(3)
      p(if5(ip),4)=rf5(4)

      p(if6(ip),1)=rf6(1)
      p(if6(ip),2)=rf6(2)
      p(if6(ip),3)=rf6(3)
      p(if6(ip),4)=rf6(4)

      elseif (jpt .eq. 4) then
      p(if1(ip),1)=sf1(1)
      p(if1(ip),2)=sf1(2)
      p(if1(ip),3)=sf1(3)
      p(if1(ip),4)=sf1(4)

      p(if2(ip),1)=sf2(1)
      p(if2(ip),2)=sf2(2)
      p(if2(ip),3)=sf2(3)
      p(if2(ip),4)=sf2(4)

      p(if3(ip),1)=sf3(1)
      p(if3(ip),2)=sf3(2)
      p(if3(ip),3)=sf3(3)
      p(if3(ip),4)=sf3(4)

      p(if4(ip),1)=sf4(1)
      p(if4(ip),2)=sf4(2)
      p(if4(ip),3)=sf4(3)
      p(if4(ip),4)=sf4(4)

      p(if5(ip),1)=sf5(1)
      p(if5(ip),2)=sf5(2)
      p(if5(ip),3)=sf5(3)
      p(if5(ip),4)=sf5(4)

      p(if6(ip),1)=sf6(1)
      p(if6(ip),2)=sf6(2)
      p(if6(ip),3)=sf6(3)
      p(if6(ip),4)=sf6(4)

      elseif (jpt .eq. 5) then
      p(if1(ip),1)=tf1(1)
      p(if1(ip),2)=tf1(2)
      p(if1(ip),3)=tf1(3)
      p(if1(ip),4)=tf1(4)

      p(if2(ip),1)=tf2(1)
      p(if2(ip),2)=tf2(2)
      p(if2(ip),3)=tf2(3)
      p(if2(ip),4)=tf2(4)

      p(if3(ip),1)=tf3(1)
      p(if3(ip),2)=tf3(2)
      p(if3(ip),3)=tf3(3)
      p(if3(ip),4)=tf3(4)

      p(if4(ip),1)=tf4(1)
      p(if4(ip),2)=tf4(2)
      p(if4(ip),3)=tf4(3)
      p(if4(ip),4)=tf4(4)

      p(if5(ip),1)=tf5(1)
      p(if5(ip),2)=tf5(2)
      p(if5(ip),3)=tf5(3)
      p(if5(ip),4)=tf5(4)

      p(if6(ip),1)=tf6(1)
      p(if6(ip),2)=tf6(2)
      p(if6(ip),3)=tf6(3)
      p(if6(ip),4)=tf6(4)

      endif

      write(*,*) 'Small: s(',if5(ip),',',ii6(ip),') =',
     . 2d0*dot(p,if5(ip),ii6(ip))
      endif      

      return
      end
















