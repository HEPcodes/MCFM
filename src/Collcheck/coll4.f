      subroutine coll4(p,i,jpt)
      implicit none
      include 'constants.f'
      integer i,jpt,ii1(4),ii2(4),ii3(4),ii4(4),ii5(4),ii6(4),
     .              if1(1),if2(1),if3(1),if4(1),if5(1),if6(1),
     .        iorf(5),pntr(5),ip
      double precision p(mxpart,4),dot,
     . pi1(4),pi2(4),pi3(4),pi4(4),pi5(4),pi6(4),
     . qi1(4),qi2(4),qi3(4),qi4(4),qi5(4),qi6(4),
     . ri1(4),ri2(4),ri3(4),ri4(4),ri5(4),ri6(4),
     . si1(4),si2(4),si3(4),si4(4),si5(4),si6(4),
     . ti1(4),ti2(4),ti3(4),ti4(4),ti5(4),ti6(4),
     . pf1(4),pf2(4),pf3(4),pf4(4),pf5(4),pf6(4),
     . qf1(4),qf2(4),qf3(4),qf4(4),qf5(4),qf6(4),
     . rf1(4),rf2(4),rf3(4),rf4(4),rf5(4),rf6(4),
     . sf1(4),sf2(4),sf3(4),sf4(4),sf5(4),sf6(4),
     . tf1(4),tf2(4),tf3(4),tf4(4),tf5(4),tf6(4)

c--- momenta for (1,6) collinear
      data pi1/     0.00000000000000d0,    0.00000000000000d0,
     .   -730.21898065664811d0, -730.21898065664811d0/
      data pi2/     0.00000000000000d0,    0.00000000000000d0,
     .      7.05149569372325d0,   -7.05149569372325d0/
      data pi3/   -20.33138908152941d0,  -15.14043020045058d0,
     .    191.38231732564742d0,  193.05385101979724d0/
      data pi4/    29.97674079579519d0,   28.90618773086630d0,
     .     85.68553440277469d0,   95.26900589257482d0/
      data pi5/    -9.72718228495936d0,  -13.81337588913702d0,
     .     48.68660622006131d0,   51.53458114593279d0/
      data pi6/     0.08183057069359d0,    0.04761835872129d0,
     .    397.41302701444141d0,  397.41303829206652d0/

      data qi1/     0.00000000000000d0,    0.00000000000000d0,
     .    -40.36468069843748d0,  -40.36468069843748d0/
      data qi2/     0.00000000000000d0,    0.00000000000000d0,
     .    513.52586607904959d0, -513.52586607904959d0/
      data qi3/    21.55486254939770d0,   28.86005142055813d0,
     .   -428.52878408883987d0,  430.04003704327368d0/
      data qi4/     2.97442300712757d0,  -27.02598011502653d0,
     .    -72.43750331588774d0,   77.37210530961653d0/
      data qi5/   -24.71321294929292d0,   -1.83270248550664d0,
     .      7.10778425440494d0,   25.78026938735607d0/
      data qi6/     0.18392739276765d0,   -0.00136882002496d0,
     .     20.69731776971057d0,   20.69813503724081d0/

      data ri1/     0.00000000000000d0,    0.00000000000000d0,
     .    -59.51002321384775d0,  -59.51002321384775d0/
      data ri2/     0.00000000000000d0,    0.00000000000000d0,
     .     69.20965966778110d0,  -69.20965966778110d0/
      data ri3/   -23.93496318761922d0,   22.37748730072310d0,
     .    -18.63644451838333d0,   37.69550987814717d0/
      data ri4/    26.71105889971003d0,  -38.60698182746812d0,
     .    -14.80015223594814d0,   49.22422391036219d0/
      data ri5/    -2.89232819417197d0,   16.33268788277522d0,
     .     -1.41541688488107d0,   16.64709166241842d0/
      data ri6/     0.11623248208116d0,   -0.10319335603020d0,
     .     25.15237718527920d0,   25.15285743070106d0/

      data si1/     0.00000000000000d0,    0.00000000000000d0,
     .   -523.87536046344906d0, -523.87536046344906d0/
      data si2/     0.00000000000000d0,    0.00000000000000d0,
     .      8.40194616616829d0,   -8.40194616616829d0/
      data si3/    12.87404572276197d0,   11.45388669759424d0,
     .      8.31622167150198d0,   19.13353382526737d0/
      data si4/   -12.95686844522462d0,  -29.78435033002201d0,
     .    218.57314039911645d0,  220.97331438076458d0/
      data si5/     0.05430429623023d0,   18.49002978834717d0,
     .     45.87143467166166d0,   49.45778674149378d0/
      data si6/     0.02851842623242d0,   -0.15956615591939d0,
     .    242.71261755500072d0,  242.71267168209161d0/

      data ti1/     0.00000000000000d0,    0.00000000000000d0,
     .   -390.44630142243795d0, -390.44630142243795d0/
      data ti2/     0.00000000000000d0,    0.00000000000000d0,
     .    384.33286767483298d0, -384.33286767483298d0/
      data ti3/   -58.51407151801757d0,   58.79779854169407d0,
     .    -58.11396774917647d0,  101.28332008044384d0/
      data ti4/   -55.53035898454837d0,  198.19786863616537d0,
     .   -198.20002359745121d0,  285.74335557437149d0/
      data ti5/   114.04104251288508d0, -256.95346205674110d0,
     .    252.63954907940183d0,  377.96452584788199d0/
      data ti6/     0.00338798968086d0,   -0.04220512111834d0,
     .      9.78787601483083d0,    9.78796759457362d0/

c--- momenta for (5,6) collinear
      data pf1/     0.00000000000000d0,    0.00000000000000d0,
     .     -4.23484364259929d0,   -4.23484364259929d0/
      data pf2/     0.00000000000000d0,    0.00000000000000d0,
     .    709.67503660968146d0, -709.67503660968146d0/
      data pf3/    36.89052397499393d0,   25.39366656460788d0,
     .   -481.84239172254900d0,  483.91924896789385d0/
      data pf4/   -15.22315361520313d0,  -21.91297839519549d0,
     .   -169.87981201633443d0,  171.96241903057046d0/
      data pf5/    -2.93754572659364d0,   -0.38649451407504d0,
     .     -7.24690920602789d0,    7.82919190885308d0/
      data pf6/   -18.72982463319716d0,   -3.09419365533735d0,
     .    -46.47108002217080d0,   50.19902034496342d0/

      data qf1/     0.00000000000000d0,    0.00000000000000d0,
     .    -11.45465826607408d0,  -11.45465826607408d0/
      data qf2/     0.00000000000000d0,    0.00000000000000d0,
     .    713.84563422244037d0, -713.84563422244037d0/
      data qf3/    21.22459373329407d0,    8.45216713067453d0,
     .   -343.17162418688014d0,  343.93122300164833d0/
      data qf4/   -47.20027390027090d0,    9.72794364307645d0,
     .   -341.82244492628712d0,  345.20295856085596d0/
      data qf5/     0.99976081139586d0,   -0.75308378379573d0,
     .     -0.72701387776639d0,    1.44748265754168d0/
      data qf6/    24.97591935558097d0,  -17.42702698995524d0,
     .    -16.66989296543269d0,   34.71862826846843d0/

      data rf1/     0.00000000000000d0,    0.00000000000000d0,
     .    -12.53808806841507d0,  -12.53808806841507d0/
      data rf2/     0.00000000000000d0,    0.00000000000000d0,
     .    184.88252237894721d0, -184.88252237894721d0/
      data rf3/    24.11927708348935d0,   11.30799561695331d0,
     .    -18.27509258996331d0,   32.30463281133066d0/
      data rf4/    -9.39192749806506d0,    3.39610727755483d0,
     .   -139.15058829635376d0,  139.50852328797305d0/
      data rf5/    -7.04926519045416d0,   -7.11418692780560d0,
     .     -7.32419726520312d0,   12.40756466631215d0/
      data rf6/    -7.67808439497013d0,   -7.58991596670253d0,
     .     -7.59455615901193d0,   13.19988968174643d0/

      data sf1/     0.00000000000000d0,    0.00000000000000d0,
     .     -6.39140837555875d0,   -6.39140837555875d0/
      data sf2/     0.00000000000000d0,    0.00000000000000d0,
     .    711.32380702182115d0, -711.32380702182115d0/
      data sf3/    33.32060851851805d0,    9.38426063399273d0,
     .   -111.10514621810474d0,  116.37302443366107d0/
      data sf4/    -0.24591738516580d0,  -27.90579490809308d0,
     .   -490.28910162224514d0,  491.08267841002203d0/
      data sf5/   -31.72584926155483d0,   17.80453014170119d0,
     .    -99.36081184097941d0,  105.81163326700973d0/
      data sf6/    -1.34884187179742d0,    0.71700413239916d0,
     .     -4.17733896493314d0,    4.44787928668710d0/

      data tf1/     0.00000000000000d0,    0.00000000000000d0,
     .    -93.15967405149394d0,  -93.15967405149394d0/
      data tf2/     0.00000000000000d0,    0.00000000000000d0,
     .     39.82965428937700d0,  -39.82965428937700d0/
      data tf3/    38.36330660795711d0,  -30.01553967754145d0,
     .     30.61944485387436d0,   57.53456629878810d0/
      data tf4/    -3.55778759152373d0,   16.69099232139023d0,
     .    -14.79085287884447d0,   22.58354281557103d0/
      data tf5/    -5.85770406889924d0,    2.18195177216580d0,
     .      6.36134795509080d0,    8.91854014402549d0/
      data tf6/   -28.94781494753413d0,   11.14259558398542d0,
     .     31.14007983199625d0,   43.95267908248633d0/
    
c--- jpt picks the momentum configuration (1..5)
c--- k picks the collinear pair:
c---  1   2   3   4   5 
c---  16  26  56  15  25

c--- handle permutations (initial,final)
      data ii1/1,2,1,2/
      data ii2/2,1,2,1/
      data ii3/3,3,3,3/
      data ii4/4,4,4,4/
      data ii5/5,5,6,6/
      data ii6/6,6,5,5/
c--- handle permutations (final,final)
      data if1/1/
      data if2/2/
      data if3/3/
      data if4/4/
      data if5/5/
      data if6/6/

c-- translate i to (i,f)/(f,f) and perm
      data iorf/1,1,2,1,1/
      data pntr/1,2,1,3,4/

      ip=pntr(i)

      if (iorf(i) .eq. 1) then
c--- initial-final case
      if (jpt .eq. 1) then
      p(ii1(ip),1)=pi1(1)
      p(ii1(ip),2)=pi1(2)
      p(ii1(ip),3)=pi1(3)
      p(ii1(ip),4)=pi1(4)

      p(ii2(ip),1)=pi2(1)
      p(ii2(ip),2)=pi2(2)
      p(ii2(ip),3)=pi2(3)
      p(ii2(ip),4)=pi2(4)

      p(ii3(ip),1)=pi3(1)
      p(ii3(ip),2)=pi3(2)
      p(ii3(ip),3)=pi3(3)
      p(ii3(ip),4)=pi3(4)

      p(ii4(ip),1)=pi4(1)
      p(ii4(ip),2)=pi4(2)
      p(ii4(ip),3)=pi4(3)
      p(ii4(ip),4)=pi4(4)

      p(ii5(ip),1)=pi5(1)
      p(ii5(ip),2)=pi5(2)
      p(ii5(ip),3)=pi5(3)
      p(ii5(ip),4)=pi5(4)

      p(ii6(ip),1)=pi6(1)
      p(ii6(ip),2)=pi6(2)
      p(ii6(ip),3)=pi6(3)
      p(ii6(ip),4)=pi6(4)

      elseif (jpt .eq. 2) then
      p(ii1(ip),1)=qi1(1)
      p(ii1(ip),2)=qi1(2)
      p(ii1(ip),3)=qi1(3)
      p(ii1(ip),4)=qi1(4)

      p(ii2(ip),1)=qi2(1)
      p(ii2(ip),2)=qi2(2)
      p(ii2(ip),3)=qi2(3)
      p(ii2(ip),4)=qi2(4)

      p(ii3(ip),1)=qi3(1)
      p(ii3(ip),2)=qi3(2)
      p(ii3(ip),3)=qi3(3)
      p(ii3(ip),4)=qi3(4)

      p(ii4(ip),1)=qi4(1)
      p(ii4(ip),2)=qi4(2)
      p(ii4(ip),3)=qi4(3)
      p(ii4(ip),4)=qi4(4)

      p(ii5(ip),1)=qi5(1)
      p(ii5(ip),2)=qi5(2)
      p(ii5(ip),3)=qi5(3)
      p(ii5(ip),4)=qi5(4)

      p(ii6(ip),1)=qi6(1)
      p(ii6(ip),2)=qi6(2)
      p(ii6(ip),3)=qi6(3)
      p(ii6(ip),4)=qi6(4)

      elseif (jpt .eq. 3) then
      p(ii1(ip),1)=ri1(1)
      p(ii1(ip),2)=ri1(2)
      p(ii1(ip),3)=ri1(3)
      p(ii1(ip),4)=ri1(4)

      p(ii2(ip),1)=ri2(1)
      p(ii2(ip),2)=ri2(2)
      p(ii2(ip),3)=ri2(3)
      p(ii2(ip),4)=ri2(4)

      p(ii3(ip),1)=ri3(1)
      p(ii3(ip),2)=ri3(2)
      p(ii3(ip),3)=ri3(3)
      p(ii3(ip),4)=ri3(4)

      p(ii4(ip),1)=ri4(1)
      p(ii4(ip),2)=ri4(2)
      p(ii4(ip),3)=ri4(3)
      p(ii4(ip),4)=ri4(4)

      p(ii5(ip),1)=ri5(1)
      p(ii5(ip),2)=ri5(2)
      p(ii5(ip),3)=ri5(3)
      p(ii5(ip),4)=ri5(4)

      p(ii6(ip),1)=ri6(1)
      p(ii6(ip),2)=ri6(2)
      p(ii6(ip),3)=ri6(3)
      p(ii6(ip),4)=ri6(4)

      elseif (jpt .eq. 4) then
      p(ii1(ip),1)=si1(1)
      p(ii1(ip),2)=si1(2)
      p(ii1(ip),3)=si1(3)
      p(ii1(ip),4)=si1(4)

      p(ii2(ip),1)=si2(1)
      p(ii2(ip),2)=si2(2)
      p(ii2(ip),3)=si2(3)
      p(ii2(ip),4)=si2(4)

      p(ii3(ip),1)=si3(1)
      p(ii3(ip),2)=si3(2)
      p(ii3(ip),3)=si3(3)
      p(ii3(ip),4)=si3(4)

      p(ii4(ip),1)=si4(1)
      p(ii4(ip),2)=si4(2)
      p(ii4(ip),3)=si4(3)
      p(ii4(ip),4)=si4(4)

      p(ii5(ip),1)=si5(1)
      p(ii5(ip),2)=si5(2)
      p(ii5(ip),3)=si5(3)
      p(ii5(ip),4)=si5(4)

      p(ii6(ip),1)=si6(1)
      p(ii6(ip),2)=si6(2)
      p(ii6(ip),3)=si6(3)
      p(ii6(ip),4)=si6(4)

      elseif (jpt .eq. 5) then
      p(ii1(ip),1)=ti1(1)
      p(ii1(ip),2)=ti1(2)
      p(ii1(ip),3)=ti1(3)
      p(ii1(ip),4)=ti1(4)

      p(ii2(ip),1)=ti2(1)
      p(ii2(ip),2)=ti2(2)
      p(ii2(ip),3)=ti2(3)
      p(ii2(ip),4)=ti2(4)

      p(ii3(ip),1)=ti3(1)
      p(ii3(ip),2)=ti3(2)
      p(ii3(ip),3)=ti3(3)
      p(ii3(ip),4)=ti3(4)

      p(ii4(ip),1)=ti4(1)
      p(ii4(ip),2)=ti4(2)
      p(ii4(ip),3)=ti4(3)
      p(ii4(ip),4)=ti4(4)

      p(ii5(ip),1)=ti5(1)
      p(ii5(ip),2)=ti5(2)
      p(ii5(ip),3)=ti5(3)
      p(ii5(ip),4)=ti5(4)

      p(ii6(ip),1)=ti6(1)
      p(ii6(ip),2)=ti6(2)
      p(ii6(ip),3)=ti6(3)
      p(ii6(ip),4)=ti6(4)

      endif
      write(*,*) 'Small: s(',ii1(ip),',',ii6(ip),') =',
     . 2d0*dot(p,ii1(ip),ii6(ip))
      else
c--- final-final case
      if (jpt .eq. 1) then
      p(if1(ip),1)=pf1(1)
      p(if1(ip),2)=pf1(2)
      p(if1(ip),3)=pf1(3)
      p(if1(ip),4)=pf1(4)

      p(if2(ip),1)=pf2(1)
      p(if2(ip),2)=pf2(2)
      p(if2(ip),3)=pf2(3)
      p(if2(ip),4)=pf2(4)

      p(if3(ip),1)=pf3(1)
      p(if3(ip),2)=pf3(2)
      p(if3(ip),3)=pf3(3)
      p(if3(ip),4)=pf3(4)

      p(if4(ip),1)=pf4(1)
      p(if4(ip),2)=pf4(2)
      p(if4(ip),3)=pf4(3)
      p(if4(ip),4)=pf4(4)

      p(if5(ip),1)=pf5(1)
      p(if5(ip),2)=pf5(2)
      p(if5(ip),3)=pf5(3)
      p(if5(ip),4)=pf5(4)

      p(if6(ip),1)=pf6(1)
      p(if6(ip),2)=pf6(2)
      p(if6(ip),3)=pf6(3)
      p(if6(ip),4)=pf6(4)

      elseif (jpt .eq. 2) then
      p(if1(ip),1)=qf1(1)
      p(if1(ip),2)=qf1(2)
      p(if1(ip),3)=qf1(3)
      p(if1(ip),4)=qf1(4)

      p(if2(ip),1)=qf2(1)
      p(if2(ip),2)=qf2(2)
      p(if2(ip),3)=qf2(3)
      p(if2(ip),4)=qf2(4)

      p(if3(ip),1)=qf3(1)
      p(if3(ip),2)=qf3(2)
      p(if3(ip),3)=qf3(3)
      p(if3(ip),4)=qf3(4)

      p(if4(ip),1)=qf4(1)
      p(if4(ip),2)=qf4(2)
      p(if4(ip),3)=qf4(3)
      p(if4(ip),4)=qf4(4)

      p(if5(ip),1)=qf5(1)
      p(if5(ip),2)=qf5(2)
      p(if5(ip),3)=qf5(3)
      p(if5(ip),4)=qf5(4)

      p(if6(ip),1)=qf6(1)
      p(if6(ip),2)=qf6(2)
      p(if6(ip),3)=qf6(3)
      p(if6(ip),4)=qf6(4)

      elseif (jpt .eq. 3) then
      p(if1(ip),1)=rf1(1)
      p(if1(ip),2)=rf1(2)
      p(if1(ip),3)=rf1(3)
      p(if1(ip),4)=rf1(4)

      p(if2(ip),1)=rf2(1)
      p(if2(ip),2)=rf2(2)
      p(if2(ip),3)=rf2(3)
      p(if2(ip),4)=rf2(4)

      p(if3(ip),1)=rf3(1)
      p(if3(ip),2)=rf3(2)
      p(if3(ip),3)=rf3(3)
      p(if3(ip),4)=rf3(4)

      p(if4(ip),1)=rf4(1)
      p(if4(ip),2)=rf4(2)
      p(if4(ip),3)=rf4(3)
      p(if4(ip),4)=rf4(4)

      p(if5(ip),1)=rf5(1)
      p(if5(ip),2)=rf5(2)
      p(if5(ip),3)=rf5(3)
      p(if5(ip),4)=rf5(4)

      p(if6(ip),1)=rf6(1)
      p(if6(ip),2)=rf6(2)
      p(if6(ip),3)=rf6(3)
      p(if6(ip),4)=rf6(4)

      elseif (jpt .eq. 4) then
      p(if1(ip),1)=sf1(1)
      p(if1(ip),2)=sf1(2)
      p(if1(ip),3)=sf1(3)
      p(if1(ip),4)=sf1(4)

      p(if2(ip),1)=sf2(1)
      p(if2(ip),2)=sf2(2)
      p(if2(ip),3)=sf2(3)
      p(if2(ip),4)=sf2(4)

      p(if3(ip),1)=sf3(1)
      p(if3(ip),2)=sf3(2)
      p(if3(ip),3)=sf3(3)
      p(if3(ip),4)=sf3(4)

      p(if4(ip),1)=sf4(1)
      p(if4(ip),2)=sf4(2)
      p(if4(ip),3)=sf4(3)
      p(if4(ip),4)=sf4(4)

      p(if5(ip),1)=sf5(1)
      p(if5(ip),2)=sf5(2)
      p(if5(ip),3)=sf5(3)
      p(if5(ip),4)=sf5(4)

      p(if6(ip),1)=sf6(1)
      p(if6(ip),2)=sf6(2)
      p(if6(ip),3)=sf6(3)
      p(if6(ip),4)=sf6(4)

      elseif (jpt .eq. 5) then
      p(if1(ip),1)=tf1(1)
      p(if1(ip),2)=tf1(2)
      p(if1(ip),3)=tf1(3)
      p(if1(ip),4)=tf1(4)

      p(if2(ip),1)=tf2(1)
      p(if2(ip),2)=tf2(2)
      p(if2(ip),3)=tf2(3)
      p(if2(ip),4)=tf2(4)

      p(if3(ip),1)=tf3(1)
      p(if3(ip),2)=tf3(2)
      p(if3(ip),3)=tf3(3)
      p(if3(ip),4)=tf3(4)

      p(if4(ip),1)=tf4(1)
      p(if4(ip),2)=tf4(2)
      p(if4(ip),3)=tf4(3)
      p(if4(ip),4)=tf4(4)

      p(if5(ip),1)=tf5(1)
      p(if5(ip),2)=tf5(2)
      p(if5(ip),3)=tf5(3)
      p(if5(ip),4)=tf5(4)

      p(if6(ip),1)=tf6(1)
      p(if6(ip),2)=tf6(2)
      p(if6(ip),3)=tf6(3)
      p(if6(ip),4)=tf6(4)

      endif

      write(*,*) 'Small: s(',if5(ip),',',ii6(ip),') =',
     . 2d0*dot(p,if5(ip),ii6(ip))
      endif      

      return
      end
















