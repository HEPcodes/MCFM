      subroutine coll3jet(p,i,jpt)
      implicit none
      include 'constants.f'
      integer i,jpt,ii1(6),ii2(6),ii3(6),ii4(6),ii5(6),
     .              if1(3),if2(3),if3(3),if4(3),if5(3),
     .        iorf(9),pntr(9),ip
      double precision p(mxpart,4),dot,
     . pi1(4),pi2(4),pi3(4),pi4(4),pi5(4),
     . qi1(4),qi2(4),qi3(4),qi4(4),qi5(4),
     . ri1(4),ri2(4),ri3(4),ri4(4),ri5(4),
     . si1(4),si2(4),si3(4),si4(4),si5(4),
     . ti1(4),ti2(4),ti3(4),ti4(4),ti5(4),
     . pf1(4),pf2(4),pf3(4),pf4(4),pf5(4),
     . qf1(4),qf2(4),qf3(4),qf4(4),qf5(4),
     . rf1(4),rf2(4),rf3(4),rf4(4),rf5(4),
     . sf1(4),sf2(4),sf3(4),sf4(4),sf5(4),
     . tf1(4),tf2(4),tf3(4),tf4(4),tf5(4)

c---- momenta for (1,5) collinear
      data pi1/     0.00000000000000d0,    0.00000000000000d0,
     .    -18.90147020201344d0,  -18.90147020201344d0/
      data pi2/     0.00000000000000d0,    0.00000000000000d0,
     .    877.06401943576213d0, -877.06401943576213d0/
      data pi3/   -12.79519986356616d0,  -39.77290515235710d0,
     .    -21.19360301057307d0,   46.84837171531971d0/
      data pi4/    12.75744012857138d0,   39.70542045956842d0,
     .   -842.52699072627831d0,  843.55853548807363d0/
      data pi5/     0.03775973499478d0,    0.06748469278868d0,
     .      5.55804450310294d0,    5.55858243438203d0/
     
      data qi1/     0.00000000000000d0,    0.00000000000000d0,
     .    -52.43501449686013d0,  -52.43501449686013d0/
      data qi2/     0.00000000000000d0,    0.00000000000000d0,
     .    694.36114478118100d0, -694.36114478118100d0/
      data qi3/   -10.78861347054045d0,  -32.35161131954320d0,
     .   -688.24098321791257d0,  689.08538797187293d0/
      data qi4/    10.76883109135005d0,   32.34464475783960d0,
     .     45.29258495787483d0,   56.68828820621750d0/
      data qi5/     0.01978237919040d0,    0.00696656170360d0,
     .      1.02226797571694d0,    1.02248309995071d0/

      data ri1/     0.00000000000000d0,    0.00000000000000d0,
     .    -24.32232893778072d0,  -24.32232893778072d0/
      data ri2/     0.00000000000000d0,    0.00000000000000d0,
     .    328.44623442169410d0, -328.44623442169410d0/
      data ri3/   -11.04457774306656d0,  -36.21307982658623d0,
     .    -25.73722289804864d0,   45.77962964630871d0/
      data ri4/    11.22917602681470d0,   36.11226271724037d0,
     .   -291.46535883487121d0,  293.90856624729469d0/
      data ri5/    -0.18459828374814d0,    0.10081710934587d0,
     .     13.07867624900651d0,   13.08036746587138d0/
     
      data si1/     0.00000000000000d0,    0.00000000000000d0,
     .    -33.25988554708567d0,  -33.25988554708567d0/
      data si2/     0.00000000000000d0,    0.00000000000000d0,
     .     34.16239689460639d0,  -34.16239689460639d0/
      data si3/    -9.02181413611071d0,  -22.73487058785489d0,
     .    -21.94410079970488d0,   32.86047825063787d0/
      data si4/     8.93572375550001d0,   22.71533866699802d0,
     .     15.27625458861358d0,   28.79579351306645d0/
      data si5/     0.08609038061070d0,    0.01953192085687d0,
     .      5.76533486357059d0,    5.76601067798774d0/

      data ti1/     0.00000000000000d0,    0.00000000000000d0,
     .    -14.16712699635243d0,  -14.16712699635243d0/
      data ti2/     0.00000000000000d0,    0.00000000000000d0,
     .    856.37834222859101d0, -856.37834222859101d0/
      data ti3/   -23.89136912991912d0,  -31.30523970588094d0,
     .   -530.07214293147547d0,  531.53296441886960d0/
      data ti4/    23.69720546959754d0,   31.41058863261313d0,
     .   -324.38598531092617d0,  326.76359970390820d0/
      data ti5/     0.19416366032158d0,   -0.10534892673219d0,
     .     12.24691301016316d0,   12.24890510216553d0/     

c--- momenta for (4,5) collinear

      data pf1/     0.00000000000000d0,    0.00000000000000d0,
     .   -743.04691086561843d0, -743.04691086561843d0/
      data pf2/     0.00000000000000d0,    0.00000000000000d0,
     .      6.49463394678687d0,   -6.49463394678687d0/
      data pf3/    -6.08585516191925d0,  -67.49425509210477d0,
     .    450.67419244414225d0,  455.74086917750719d0/
      data pf4/     1.27269233811416d0,   14.00246849907508d0,
     .     59.68673905455586d0,   61.32043451266247d0/
      data pf5/     4.81316282380510d0,   53.49178659302968d0,
     .    226.19134542013333d0,  232.48024112223553d0/
     
      data qf1/     0.00000000000000d0,    0.00000000000000d0,
     .   -272.84509233987166d0, -272.84509233987166d0/
      data qf2/     0.00000000000000d0,    0.00000000000000d0,
     .    156.62618272401610d0, -156.62618272401610d0/
      data qf3/   -48.76178833070372d0, -156.32328253317948d0,
     .    -72.95514982393208d0,  179.26833113795922d0/
      data qf4/    48.52430857591097d0,  155.58224010589819d0,
     .    188.27480012821161d0,  249.01373922427979d0/
      data qf5/     0.23747975479275d0,    0.74104242728130d0,
     .      0.89925931157604d0,    1.18920470164879d0/

      data rf1/     0.00000000000000d0,    0.00000000000000d0,
     .   -371.38054588064915d0, -371.38054588064915d0/
      data rf2/     0.00000000000000d0,    0.00000000000000d0,
     .     63.86827781275912d0,  -63.86827781275912d0/
      data rf3/   -19.63453583454484d0,   -4.61502183024514d0,
     .    -61.99396026172334d0,   65.19251899461929d0/
      data rf4/    19.52514727302368d0,    4.59287066545390d0,
     .    367.48363427410061d0,  368.03063363840215d0/
      data rf5/     0.10938856152116d0,    0.02215116479123d0,
     .      2.02259405551270d0,    2.02567106038681d0/

      data sf1/     0.00000000000000d0,    0.00000000000000d0,
     .    -62.11686001642462d0,  -62.11686001642462d0/
      data sf2/     0.00000000000000d0,    0.00000000000000d0,
     .    946.87286170954133d0, -946.87286170954133d0/
      data sf3/  -159.00814374392974d0,  110.95976985914179d0,
     .   -745.41095824276874d0,  770.21630531460869d0/
      data sf4/    21.60819733756610d0,  -14.99224448243579d0,
     .    -18.90336270117761d0,   32.38855829166525d0/
      data sf5/   137.39994640636365d0,  -95.96752537670599d0,
     .   -120.44168074917052d0,  206.38485811969207d0/
         
      data tf1/     0.00000000000000d0,    0.00000000000000d0,
     .     -2.56603035328686d0,   -2.56603035328686d0/
      data tf2/     0.00000000000000d0,    0.00000000000000d0,
     .    829.79712826709931d0, -829.79712826709931d0/
      data tf3/   -26.41446954518818d0,   19.08686661751454d0,
     .   -118.97090494539819d0,  123.35359298437739d0/
      data tf4/    25.33779479270433d0,  -18.32928746442570d0,
     .   -680.29782050589665d0,  681.01621949039065d0/
      data tf5/     1.07667475248385d0,   -0.75757915308884d0,
     .    -27.96237246251748d0,   27.99334614561801d0/

c--- jpt picks the momentum configuration (1..5)
c--- k picks the collinear pair:
c---  1   2   3   4  5  6  7  8
c---  15  25  45 35 14 24 13 23

c--- handle permutations (initial,final)
      data ii1/1,2,1,2,1,2/
      data ii2/2,1,2,1,2,1/
      data ii3/3,3,3,3,4,4/
      data ii4/4,4,5,5,5,5/
      data ii5/5,5,4,4,3,3/
c--- handle permutations (final,final)
      data if1/1,1,1/
      data if2/2,2,2/
      data if3/3,4,5/
      data if4/4,3,3/
      data if5/5,5,4/

c-- translate i to (i,f)/(f,f) and perm
      data iorf/1,1,2,2,1,1,1,1,2/
      data pntr/1,2,1,2,3,4,5,6,3/

      ip=pntr(i)

      if (iorf(i) .eq. 1) then
c--- initial-final case
      if (jpt .eq. 1) then
      p(ii1(ip),1)=pi1(1)
      p(ii1(ip),2)=pi1(2)
      p(ii1(ip),3)=pi1(3)
      p(ii1(ip),4)=pi1(4)

      p(ii2(ip),1)=pi2(1)
      p(ii2(ip),2)=pi2(2)
      p(ii2(ip),3)=pi2(3)
      p(ii2(ip),4)=pi2(4)

      p(ii3(ip),1)=pi3(1)
      p(ii3(ip),2)=pi3(2)
      p(ii3(ip),3)=pi3(3)
      p(ii3(ip),4)=pi3(4)

      p(ii4(ip),1)=pi4(1)
      p(ii4(ip),2)=pi4(2)
      p(ii4(ip),3)=pi4(3)
      p(ii4(ip),4)=pi4(4)

      p(ii5(ip),1)=pi5(1)
      p(ii5(ip),2)=pi5(2)
      p(ii5(ip),3)=pi5(3)
      p(ii5(ip),4)=pi5(4)

      elseif (jpt .eq. 2) then
      p(ii1(ip),1)=qi1(1)
      p(ii1(ip),2)=qi1(2)
      p(ii1(ip),3)=qi1(3)
      p(ii1(ip),4)=qi1(4)

      p(ii2(ip),1)=qi2(1)
      p(ii2(ip),2)=qi2(2)
      p(ii2(ip),3)=qi2(3)
      p(ii2(ip),4)=qi2(4)

      p(ii3(ip),1)=qi3(1)
      p(ii3(ip),2)=qi3(2)
      p(ii3(ip),3)=qi3(3)
      p(ii3(ip),4)=qi3(4)

      p(ii4(ip),1)=qi4(1)
      p(ii4(ip),2)=qi4(2)
      p(ii4(ip),3)=qi4(3)
      p(ii4(ip),4)=qi4(4)

      p(ii5(ip),1)=qi5(1)
      p(ii5(ip),2)=qi5(2)
      p(ii5(ip),3)=qi5(3)
      p(ii5(ip),4)=qi5(4)

      elseif (jpt .eq. 3) then
      p(ii1(ip),1)=ri1(1)
      p(ii1(ip),2)=ri1(2)
      p(ii1(ip),3)=ri1(3)
      p(ii1(ip),4)=ri1(4)

      p(ii2(ip),1)=ri2(1)
      p(ii2(ip),2)=ri2(2)
      p(ii2(ip),3)=ri2(3)
      p(ii2(ip),4)=ri2(4)

      p(ii3(ip),1)=ri3(1)
      p(ii3(ip),2)=ri3(2)
      p(ii3(ip),3)=ri3(3)
      p(ii3(ip),4)=ri3(4)

      p(ii4(ip),1)=ri4(1)
      p(ii4(ip),2)=ri4(2)
      p(ii4(ip),3)=ri4(3)
      p(ii4(ip),4)=ri4(4)

      p(ii5(ip),1)=ri5(1)
      p(ii5(ip),2)=ri5(2)
      p(ii5(ip),3)=ri5(3)
      p(ii5(ip),4)=ri5(4)

      elseif (jpt .eq. 4) then
      p(ii1(ip),1)=si1(1)
      p(ii1(ip),2)=si1(2)
      p(ii1(ip),3)=si1(3)
      p(ii1(ip),4)=si1(4)

      p(ii2(ip),1)=si2(1)
      p(ii2(ip),2)=si2(2)
      p(ii2(ip),3)=si2(3)
      p(ii2(ip),4)=si2(4)

      p(ii3(ip),1)=si3(1)
      p(ii3(ip),2)=si3(2)
      p(ii3(ip),3)=si3(3)
      p(ii3(ip),4)=si3(4)

      p(ii4(ip),1)=si4(1)
      p(ii4(ip),2)=si4(2)
      p(ii4(ip),3)=si4(3)
      p(ii4(ip),4)=si4(4)

      p(ii5(ip),1)=si5(1)
      p(ii5(ip),2)=si5(2)
      p(ii5(ip),3)=si5(3)
      p(ii5(ip),4)=si5(4)

      elseif (jpt .eq. 5) then
      p(ii1(ip),1)=ti1(1)
      p(ii1(ip),2)=ti1(2)
      p(ii1(ip),3)=ti1(3)
      p(ii1(ip),4)=ti1(4)

      p(ii2(ip),1)=ti2(1)
      p(ii2(ip),2)=ti2(2)
      p(ii2(ip),3)=ti2(3)
      p(ii2(ip),4)=ti2(4)

      p(ii3(ip),1)=ti3(1)
      p(ii3(ip),2)=ti3(2)
      p(ii3(ip),3)=ti3(3)
      p(ii3(ip),4)=ti3(4)

      p(ii4(ip),1)=ti4(1)
      p(ii4(ip),2)=ti4(2)
      p(ii4(ip),3)=ti4(3)
      p(ii4(ip),4)=ti4(4)

      p(ii5(ip),1)=ti5(1)
      p(ii5(ip),2)=ti5(2)
      p(ii5(ip),3)=ti5(3)
      p(ii5(ip),4)=ti5(4)

      endif
      write(*,*) 'Small: s(',ii1(ip),',',ii5(ip),') =',
     . 2d0*dot(p,ii1(ip),ii5(ip))
      else
c--- final-final case
      if (jpt .eq. 1) then
      p(if1(ip),1)=pf1(1)
      p(if1(ip),2)=pf1(2)
      p(if1(ip),3)=pf1(3)
      p(if1(ip),4)=pf1(4)

      p(if2(ip),1)=pf2(1)
      p(if2(ip),2)=pf2(2)
      p(if2(ip),3)=pf2(3)
      p(if2(ip),4)=pf2(4)

      p(if3(ip),1)=pf3(1)
      p(if3(ip),2)=pf3(2)
      p(if3(ip),3)=pf3(3)
      p(if3(ip),4)=pf3(4)

      p(if4(ip),1)=pf4(1)
      p(if4(ip),2)=pf4(2)
      p(if4(ip),3)=pf4(3)
      p(if4(ip),4)=pf4(4)

      p(if5(ip),1)=pf5(1)
      p(if5(ip),2)=pf5(2)
      p(if5(ip),3)=pf5(3)
      p(if5(ip),4)=pf5(4)

      elseif (jpt .eq. 2) then
      p(if1(ip),1)=qf1(1)
      p(if1(ip),2)=qf1(2)
      p(if1(ip),3)=qf1(3)
      p(if1(ip),4)=qf1(4)

      p(if2(ip),1)=qf2(1)
      p(if2(ip),2)=qf2(2)
      p(if2(ip),3)=qf2(3)
      p(if2(ip),4)=qf2(4)

      p(if3(ip),1)=qf3(1)
      p(if3(ip),2)=qf3(2)
      p(if3(ip),3)=qf3(3)
      p(if3(ip),4)=qf3(4)

      p(if4(ip),1)=qf4(1)
      p(if4(ip),2)=qf4(2)
      p(if4(ip),3)=qf4(3)
      p(if4(ip),4)=qf4(4)

      p(if5(ip),1)=qf5(1)
      p(if5(ip),2)=qf5(2)
      p(if5(ip),3)=qf5(3)
      p(if5(ip),4)=qf5(4)

      elseif (jpt .eq. 3) then
      p(if1(ip),1)=rf1(1)
      p(if1(ip),2)=rf1(2)
      p(if1(ip),3)=rf1(3)
      p(if1(ip),4)=rf1(4)

      p(if2(ip),1)=rf2(1)
      p(if2(ip),2)=rf2(2)
      p(if2(ip),3)=rf2(3)
      p(if2(ip),4)=rf2(4)

      p(if3(ip),1)=rf3(1)
      p(if3(ip),2)=rf3(2)
      p(if3(ip),3)=rf3(3)
      p(if3(ip),4)=rf3(4)

      p(if4(ip),1)=rf4(1)
      p(if4(ip),2)=rf4(2)
      p(if4(ip),3)=rf4(3)
      p(if4(ip),4)=rf4(4)

      p(if5(ip),1)=rf5(1)
      p(if5(ip),2)=rf5(2)
      p(if5(ip),3)=rf5(3)
      p(if5(ip),4)=rf5(4)

      elseif (jpt .eq. 4) then
      p(if1(ip),1)=sf1(1)
      p(if1(ip),2)=sf1(2)
      p(if1(ip),3)=sf1(3)
      p(if1(ip),4)=sf1(4)

      p(if2(ip),1)=sf2(1)
      p(if2(ip),2)=sf2(2)
      p(if2(ip),3)=sf2(3)
      p(if2(ip),4)=sf2(4)

      p(if3(ip),1)=sf3(1)
      p(if3(ip),2)=sf3(2)
      p(if3(ip),3)=sf3(3)
      p(if3(ip),4)=sf3(4)

      p(if4(ip),1)=sf4(1)
      p(if4(ip),2)=sf4(2)
      p(if4(ip),3)=sf4(3)
      p(if4(ip),4)=sf4(4)

      p(if5(ip),1)=sf5(1)
      p(if5(ip),2)=sf5(2)
      p(if5(ip),3)=sf5(3)
      p(if5(ip),4)=sf5(4)

      elseif (jpt .eq. 5) then
      p(if1(ip),1)=tf1(1)
      p(if1(ip),2)=tf1(2)
      p(if1(ip),3)=tf1(3)
      p(if1(ip),4)=tf1(4)

      p(if2(ip),1)=tf2(1)
      p(if2(ip),2)=tf2(2)
      p(if2(ip),3)=tf2(3)
      p(if2(ip),4)=tf2(4)

      p(if3(ip),1)=tf3(1)
      p(if3(ip),2)=tf3(2)
      p(if3(ip),3)=tf3(3)
      p(if3(ip),4)=tf3(4)

      p(if4(ip),1)=tf4(1)
      p(if4(ip),2)=tf4(2)
      p(if4(ip),3)=tf4(3)
      p(if4(ip),4)=tf4(4)

      p(if5(ip),1)=tf5(1)
      p(if5(ip),2)=tf5(2)
      p(if5(ip),3)=tf5(3)
      p(if5(ip),4)=tf5(4)

      endif

      write(*,*) 'Small: s(',if4(ip),',',ii5(ip),') =',
     . 2d0*dot(p,if4(ip),ii5(ip))
      endif      

      return
      end

