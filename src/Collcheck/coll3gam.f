      subroutine coll3gam(p,i,jpt)
      implicit none
      include 'constants.f'
      integer i,jpt,ii1(4),ii2(4),ii3(4),ii4(4),ii5(4),
     .              if1(1),if2(1),if3(1),if4(1),if5(1),
     .        iorf(5),pntr(5),ip
      double precision p(mxpart,4),dot,
     . pi1(4),pi2(4),pi3(4),pi4(4),pi5(4),
     . qi1(4),qi2(4),qi3(4),qi4(4),qi5(4),
     . ri1(4),ri2(4),ri3(4),ri4(4),ri5(4),
     . si1(4),si2(4),si3(4),si4(4),si5(4),
     . ti1(4),ti2(4),ti3(4),ti4(4),ti5(4),
     . pf1(4),pf2(4),pf3(4),pf4(4),pf5(4),
     . qf1(4),qf2(4),qf3(4),qf4(4),qf5(4),
     . rf1(4),rf2(4),rf3(4),rf4(4),rf5(4),
     . sf1(4),sf2(4),sf3(4),sf4(4),sf5(4),
     . tf1(4),tf2(4),tf3(4),tf4(4),tf5(4)

c---- momenta for (1,5) collinear
      data pi1/     0.00000000000000d0,    0.00000000000000d0,
     .   -508.22226285612379d0, -508.22226285612379d0/
      data pi2/     0.00000000000000d0,    0.00000000000000d0,
     .     11.96492884986104d0,  -11.96492884986104d0/
      data pi3/   -12.96561722551349d0,  -49.27893031559852d0,
     .     68.64005331780214d0,   85.48670728574631d0/
      data pi4/    12.88997875646589d0,   49.45520790128343d0,
     .    180.83804179510207d0,  187.92117097652510d0/
      data pi5/     0.07563846904761d0,   -0.17627758568491d0,
     .    246.77923889335852d0,  246.77931344371336d0/

      data qi1/     0.00000000000000d0,    0.00000000000000d0,
     .    -23.69775139345603d0,  -23.69775139345603d0/
      data qi2/     0.00000000000000d0,    0.00000000000000d0,
     .     43.20622985781630d0,  -43.20622985781630d0/
      data qi3/    -9.06259552703473d0,  -18.70232520695979d0,
     .    -30.79328655983262d0,   37.15015616372941d0/
      data qi4/     8.96305705575548d0,   18.60580073756967d0,
     .      2.31339207571876d0,   20.78133767992028d0/
      data qi5/     0.09953847127925d0,    0.09652446939012d0,
     .      8.97141601975359d0,    8.97248740762266d0/

      data ri1/     0.00000000000000d0,    0.00000000000000d0,
     .    -12.92850402668428d0,  -12.92850402668428d0/
      data ri2/     0.00000000000000d0,    0.00000000000000d0,
     .     89.75416533020793d0,  -89.75416533020793d0/
      data ri3/    24.48913052867704d0,    0.83304759441194d0,
     .    -60.36963476507339d0,   65.15292997259213d0/
      data ri4/   -24.56352128152734d0,   -0.85402880164292d0,
     .    -21.39756234141941d0,   32.58759913060507d0/
      data ri5/     0.07439075285029d0,    0.02098120723098d0,
     .      4.94153580296916d0,    4.94214025369500d0/

      data si1/     0.00000000000000d0,    0.00000000000000d0,
     .    -29.76349968746879d0,  -29.76349968746879d0/
      data si2/     0.00000000000000d0,    0.00000000000000d0,
     .     23.04123518211965d0,  -23.04123518211965d0/
      data si3/    -7.97496537983436d0,   19.36286471997460d0,
     .      5.84305620985064d0,   21.74078905755418d0/
      data si4/     8.08611552434972d0,  -19.40589022365285d0,
     .     -7.77061140372540d0,   22.41330500469089d0/
      data si5/    -0.11115014451536d0,    0.04302550367825d0,
     .      8.64981969922389d0,    8.65064080734336d0/

      data ti1/     0.00000000000000d0,    0.00000000000000d0,
     .    -63.31537981392023d0,  -63.31537981392023d0/
      data ti2/     0.00000000000000d0,    0.00000000000000d0,
     .     18.57542607142749d0,  -18.57542607142749d0/
      data ti3/    26.58638621559449d0,   11.01473449087987d0,
     .      4.58496239519334d0,   29.14073074023142d0/
      data ti4/   -26.50974334158326d0,  -10.98741936335014d0,
     .     26.39412759340333d0,   38.98897084714592d0/
      data ti5/    -0.07664287401124d0,   -0.02731512752973d0,
     .     13.76086375389607d0,   13.76110429797039d0/

c--- momenta for (4,5) collinear
      data pf1/     0.00000000000000d0,    0.00000000000000d0,
     .    -81.09043158936686d0,  -81.09043158936686d0/
      data pf2/     0.00000000000000d0,    0.00000000000000d0,
     .     36.18436448753627d0,  -36.18436448753627d0/
      data pf3/   -45.54663114047241d0,  -28.21070975746877d0,
     .     13.80511570238891d0,   55.32559057816500d0/
      data pf4/    17.11946744779636d0,   10.47345869374434d0,
     .     11.76623725338650d0,   23.26400313378392d0/
      data pf5/    28.42716369267606d0,   17.73725106372443d0,
     .     19.33471414605517d0,   38.68520236495421d0/

      data qf1/     0.00000000000000d0,    0.00000000000000d0,
     .   -189.75628703105679d0, -189.75628703105679d0/
      data qf2/     0.00000000000000d0,    0.00000000000000d0,
     .     42.04117669809597d0,  -42.04117669809597d0/
      data qf3/   -56.28821149196172d0,   68.37659574078573d0,
     .     88.86989299803329d0,  125.46545133838453d0/
      data qf4/    26.76896301237254d0,  -32.61423271499964d0,
     .     28.01965619375967d0,   50.64944905487539d0/
      data qf5/    29.51924847958918d0,  -35.76236302578609d0,
     .     30.82556114116785d0,   55.68256333589284d0/

      data rf1/     0.00000000000000d0,    0.00000000000000d0,
     .   -629.02290962546556d0, -629.02290962546556d0/
      data rf2/     0.00000000000000d0,    0.00000000000000d0,
     .      2.82472005467091d0,   -2.82472005467091d0/
      data rf3/   -40.30671669437370d0,   10.98950522260253d0,
     .    355.10095205098560d0,  357.55011786214595d0/
      data rf4/    27.24896827198546d0,   -7.45483491854959d0,
     .    183.61373744441096d0,  185.77428620198111d0/
      data rf5/    13.05774842238824d0,   -3.53467030405294d0,
     .     87.48350007539807d0,   88.52322561600943d0/

      data sf1/     0.00000000000000d0,    0.00000000000000d0,
     .    -10.36359456109656d0,  -10.36359456109656d0/
      data sf2/     0.00000000000000d0,    0.00000000000000d0,
     .    142.87704020004986d0, -142.87704020004986d0/
      data sf3/    -3.64829034128617d0,   37.97999715292823d0,
     .    -56.32239770019942d0,   68.02942516918827d0/
      data sf4/     2.12560977949838d0,  -23.40778218301077d0,
     .    -46.77667744395978d0,   52.34978544710792d0/
      data sf5/     1.52268056178779d0,  -14.57221496991746d0,
     .    -29.41437049479410d0,   32.86142414485023d0/

      data tf1/     0.00000000000000d0,    0.00000000000000d0,
     .    -14.41109789494869d0,  -14.41109789494869d0/
      data tf2/     0.00000000000000d0,    0.00000000000000d0,
     .     67.50725089043426d0,  -67.50725089043426d0/
      data tf3/   -22.07428127695180d0,   20.95034419661311d0,
     .    -35.51552663770460d0,   46.77118181320684d0/
      data tf4/    14.61069264969873d0,  -13.94249327773830d0,
     .    -11.55640504921916d0,   23.26834665732304d0/
      data tf5/     7.46358862725307d0,   -7.00785091887481d0,
     .     -6.02422130856182d0,   11.87882031485307d0/

c--- jpt picks the momentum configuration (1..5)
c--- k picks the collinear pair:
c---  1   2   3   4   5 
c---  15  25  45  14 24

c--- handle permutations (initial,final)
      data ii1/1,2,1,2/
      data ii2/2,1,2,1/
      data ii3/3,3,3,3/
      data ii4/4,4,5,5/
      data ii5/5,5,4,4/
c--- handle permutations (final,final)
      data if1/1/
      data if2/2/
      data if3/3/
      data if4/4/
      data if5/5/

c-- translate i to (i,f)/(f,f) and perm
      data iorf/1,1,2,1,1/
      data pntr/1,2,1,3,4/

      ip=pntr(i)

      if (iorf(i) .eq. 1) then
c--- initial-final case
      if (jpt .eq. 1) then
      p(ii1(ip),1)=pi1(1)
      p(ii1(ip),2)=pi1(2)
      p(ii1(ip),3)=pi1(3)
      p(ii1(ip),4)=pi1(4)

      p(ii2(ip),1)=pi2(1)
      p(ii2(ip),2)=pi2(2)
      p(ii2(ip),3)=pi2(3)
      p(ii2(ip),4)=pi2(4)

      p(ii3(ip),1)=pi3(1)
      p(ii3(ip),2)=pi3(2)
      p(ii3(ip),3)=pi3(3)
      p(ii3(ip),4)=pi3(4)

      p(ii4(ip),1)=pi4(1)
      p(ii4(ip),2)=pi4(2)
      p(ii4(ip),3)=pi4(3)
      p(ii4(ip),4)=pi4(4)

      p(ii5(ip),1)=pi5(1)
      p(ii5(ip),2)=pi5(2)
      p(ii5(ip),3)=pi5(3)
      p(ii5(ip),4)=pi5(4)

      elseif (jpt .eq. 2) then
      p(ii1(ip),1)=qi1(1)
      p(ii1(ip),2)=qi1(2)
      p(ii1(ip),3)=qi1(3)
      p(ii1(ip),4)=qi1(4)

      p(ii2(ip),1)=qi2(1)
      p(ii2(ip),2)=qi2(2)
      p(ii2(ip),3)=qi2(3)
      p(ii2(ip),4)=qi2(4)

      p(ii3(ip),1)=qi3(1)
      p(ii3(ip),2)=qi3(2)
      p(ii3(ip),3)=qi3(3)
      p(ii3(ip),4)=qi3(4)

      p(ii4(ip),1)=qi4(1)
      p(ii4(ip),2)=qi4(2)
      p(ii4(ip),3)=qi4(3)
      p(ii4(ip),4)=qi4(4)

      p(ii5(ip),1)=qi5(1)
      p(ii5(ip),2)=qi5(2)
      p(ii5(ip),3)=qi5(3)
      p(ii5(ip),4)=qi5(4)

      elseif (jpt .eq. 3) then
      p(ii1(ip),1)=ri1(1)
      p(ii1(ip),2)=ri1(2)
      p(ii1(ip),3)=ri1(3)
      p(ii1(ip),4)=ri1(4)

      p(ii2(ip),1)=ri2(1)
      p(ii2(ip),2)=ri2(2)
      p(ii2(ip),3)=ri2(3)
      p(ii2(ip),4)=ri2(4)

      p(ii3(ip),1)=ri3(1)
      p(ii3(ip),2)=ri3(2)
      p(ii3(ip),3)=ri3(3)
      p(ii3(ip),4)=ri3(4)

      p(ii4(ip),1)=ri4(1)
      p(ii4(ip),2)=ri4(2)
      p(ii4(ip),3)=ri4(3)
      p(ii4(ip),4)=ri4(4)

      p(ii5(ip),1)=ri5(1)
      p(ii5(ip),2)=ri5(2)
      p(ii5(ip),3)=ri5(3)
      p(ii5(ip),4)=ri5(4)

      elseif (jpt .eq. 4) then
      p(ii1(ip),1)=si1(1)
      p(ii1(ip),2)=si1(2)
      p(ii1(ip),3)=si1(3)
      p(ii1(ip),4)=si1(4)

      p(ii2(ip),1)=si2(1)
      p(ii2(ip),2)=si2(2)
      p(ii2(ip),3)=si2(3)
      p(ii2(ip),4)=si2(4)

      p(ii3(ip),1)=si3(1)
      p(ii3(ip),2)=si3(2)
      p(ii3(ip),3)=si3(3)
      p(ii3(ip),4)=si3(4)

      p(ii4(ip),1)=si4(1)
      p(ii4(ip),2)=si4(2)
      p(ii4(ip),3)=si4(3)
      p(ii4(ip),4)=si4(4)

      p(ii5(ip),1)=si5(1)
      p(ii5(ip),2)=si5(2)
      p(ii5(ip),3)=si5(3)
      p(ii5(ip),4)=si5(4)

      elseif (jpt .eq. 5) then
      p(ii1(ip),1)=ti1(1)
      p(ii1(ip),2)=ti1(2)
      p(ii1(ip),3)=ti1(3)
      p(ii1(ip),4)=ti1(4)

      p(ii2(ip),1)=ti2(1)
      p(ii2(ip),2)=ti2(2)
      p(ii2(ip),3)=ti2(3)
      p(ii2(ip),4)=ti2(4)

      p(ii3(ip),1)=ti3(1)
      p(ii3(ip),2)=ti3(2)
      p(ii3(ip),3)=ti3(3)
      p(ii3(ip),4)=ti3(4)

      p(ii4(ip),1)=ti4(1)
      p(ii4(ip),2)=ti4(2)
      p(ii4(ip),3)=ti4(3)
      p(ii4(ip),4)=ti4(4)

      p(ii5(ip),1)=ti5(1)
      p(ii5(ip),2)=ti5(2)
      p(ii5(ip),3)=ti5(3)
      p(ii5(ip),4)=ti5(4)

      endif
      write(*,*) 'Small: s(',ii1(ip),',',ii5(ip),') =',
     . 2d0*dot(p,ii1(ip),ii5(ip))
      else
c--- final-final case
      if (jpt .eq. 1) then
      p(if1(ip),1)=pf1(1)
      p(if1(ip),2)=pf1(2)
      p(if1(ip),3)=pf1(3)
      p(if1(ip),4)=pf1(4)

      p(if2(ip),1)=pf2(1)
      p(if2(ip),2)=pf2(2)
      p(if2(ip),3)=pf2(3)
      p(if2(ip),4)=pf2(4)

      p(if3(ip),1)=pf3(1)
      p(if3(ip),2)=pf3(2)
      p(if3(ip),3)=pf3(3)
      p(if3(ip),4)=pf3(4)

      p(if4(ip),1)=pf4(1)
      p(if4(ip),2)=pf4(2)
      p(if4(ip),3)=pf4(3)
      p(if4(ip),4)=pf4(4)

      p(if5(ip),1)=pf5(1)
      p(if5(ip),2)=pf5(2)
      p(if5(ip),3)=pf5(3)
      p(if5(ip),4)=pf5(4)

      elseif (jpt .eq. 2) then
      p(if1(ip),1)=qf1(1)
      p(if1(ip),2)=qf1(2)
      p(if1(ip),3)=qf1(3)
      p(if1(ip),4)=qf1(4)

      p(if2(ip),1)=qf2(1)
      p(if2(ip),2)=qf2(2)
      p(if2(ip),3)=qf2(3)
      p(if2(ip),4)=qf2(4)

      p(if3(ip),1)=qf3(1)
      p(if3(ip),2)=qf3(2)
      p(if3(ip),3)=qf3(3)
      p(if3(ip),4)=qf3(4)

      p(if4(ip),1)=qf4(1)
      p(if4(ip),2)=qf4(2)
      p(if4(ip),3)=qf4(3)
      p(if4(ip),4)=qf4(4)

      p(if5(ip),1)=qf5(1)
      p(if5(ip),2)=qf5(2)
      p(if5(ip),3)=qf5(3)
      p(if5(ip),4)=qf5(4)

      elseif (jpt .eq. 3) then
      p(if1(ip),1)=rf1(1)
      p(if1(ip),2)=rf1(2)
      p(if1(ip),3)=rf1(3)
      p(if1(ip),4)=rf1(4)

      p(if2(ip),1)=rf2(1)
      p(if2(ip),2)=rf2(2)
      p(if2(ip),3)=rf2(3)
      p(if2(ip),4)=rf2(4)

      p(if3(ip),1)=rf3(1)
      p(if3(ip),2)=rf3(2)
      p(if3(ip),3)=rf3(3)
      p(if3(ip),4)=rf3(4)

      p(if4(ip),1)=rf4(1)
      p(if4(ip),2)=rf4(2)
      p(if4(ip),3)=rf4(3)
      p(if4(ip),4)=rf4(4)

      p(if5(ip),1)=rf5(1)
      p(if5(ip),2)=rf5(2)
      p(if5(ip),3)=rf5(3)
      p(if5(ip),4)=rf5(4)

      elseif (jpt .eq. 4) then
      p(if1(ip),1)=sf1(1)
      p(if1(ip),2)=sf1(2)
      p(if1(ip),3)=sf1(3)
      p(if1(ip),4)=sf1(4)

      p(if2(ip),1)=sf2(1)
      p(if2(ip),2)=sf2(2)
      p(if2(ip),3)=sf2(3)
      p(if2(ip),4)=sf2(4)

      p(if3(ip),1)=sf3(1)
      p(if3(ip),2)=sf3(2)
      p(if3(ip),3)=sf3(3)
      p(if3(ip),4)=sf3(4)

      p(if4(ip),1)=sf4(1)
      p(if4(ip),2)=sf4(2)
      p(if4(ip),3)=sf4(3)
      p(if4(ip),4)=sf4(4)

      p(if5(ip),1)=sf5(1)
      p(if5(ip),2)=sf5(2)
      p(if5(ip),3)=sf5(3)
      p(if5(ip),4)=sf5(4)

      elseif (jpt .eq. 5) then
      p(if1(ip),1)=tf1(1)
      p(if1(ip),2)=tf1(2)
      p(if1(ip),3)=tf1(3)
      p(if1(ip),4)=tf1(4)

      p(if2(ip),1)=tf2(1)
      p(if2(ip),2)=tf2(2)
      p(if2(ip),3)=tf2(3)
      p(if2(ip),4)=tf2(4)

      p(if3(ip),1)=tf3(1)
      p(if3(ip),2)=tf3(2)
      p(if3(ip),3)=tf3(3)
      p(if3(ip),4)=tf3(4)

      p(if4(ip),1)=tf4(1)
      p(if4(ip),2)=tf4(2)
      p(if4(ip),3)=tf4(3)
      p(if4(ip),4)=tf4(4)

      p(if5(ip),1)=tf5(1)
      p(if5(ip),2)=tf5(2)
      p(if5(ip),3)=tf5(3)
      p(if5(ip),4)=tf5(4)

      endif

      write(*,*) 'Small: s(',if4(ip),',',ii5(ip),') =',
     . 2d0*dot(p,if4(ip),ii5(ip))
      endif      

      return
      end

